using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;

namespace dotnet_cyberpunk_challenge_2._5.malware_daemons.lib
{
    public enum EncryptionType {
        SSL = 0,
        CLEAR_TEXT = 1,

    }

    public class KnownIceTypes {
        public const string HITACHI = "0x98ad4321";
        public const string HOSAKA = "0x43ce4691";
        public const string KIROSHI = "0x02ace587";
        public const string UNKNOWN = "unknown"; 
    }

    static class HttpResponseMessageExtensions
    {
        internal static void WriteRequestToConsole(this HttpResponseMessage response)
        {
            if (response is null)
            {
                return;
            }

            var request = response.RequestMessage;
            Console.Write($"{request?.Method} ");
            Console.Write($"{request?.RequestUri} ");
            Console.WriteLine($"HTTP/{request?.Version}");        
        }
    }

    static class Helpers {
        public static Dictionary<string,string> JsonToDictionary(this string json) {
            Dictionary<string, object>? objectValues = JsonSerializer.Deserialize<Dictionary<string, object>>(json);

            IEnumerable<KeyValuePair<string, string>> stringValues = objectValues.Select(o => new KeyValuePair<string, string>(o.Key, o.Value?.ToString()));
            return stringValues.ToDictionary(pair => pair.Key, pair => pair.Value);
        }

        public static ArasakaMessageRoot ToArasakaMessage(this string json){
            ArasakaMessageRoot message = JsonSerializer.Deserialize<ArasakaMessageRoot>(json);
            return message;
        }
    }

}